{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst API_KEY = '46490288-24919c30ba7303f136305d546';\n\nasync function fetchImages({ page, perPage, searchTerm }) {\n  const { data } = await axios.get('', {\n    params: {\n      key: API_KEY,\n      q: searchTerm,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: perPage,\n    },\n  });\n  return data;\n}\n\nexport { fetchImages };\n","function generateImageMarkup(images) {\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class='photo-item'>\n        <a class=\"photo-link\" href=\"${largeImageURL}\" >\n\t\t<img\n\t\t\tclass=\"photo-image\"\n\t\t\tsrc=\"${webformatURL}\"\n\t\t\talt=\"${tags}\"\n            width='358'\n            height='200'\n\t\t\t/>\n\t</a>\n    <ul class='img-info'>\n    <li><p>Likes</p><p>${likes}</p></li>\n    <li><p>Views</p><p>${views}</p></li>\n    <li><p>Comments</p><p>${comments}</p></li>\n    <li><p>Downloads</p><p>${downloads}</p></li>\n    </ul>\n</li>`;\n      }\n    )\n    .join('');\n}\n\nexport default generateImageMarkup;\n","import { fetchImages } from './js/pixabay-api';\nimport generateImageMarkup from './js/render-functions';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet galleryModal = new SimpleLightbox('.photo-link', {\n  captionDelay: 250,\n  captionsData: 'alt',\n});\n\nconst galleryEl = document.querySelector('.photo-gallery');\nconst loadingSpinner = document.querySelector('.loading-indicator');\nconst loadMoreButton = document.querySelector('.load-more-btn');\nconst searchFormEl = document.querySelector('.search-form');\n\nconst queryParams = {\n  page: 1,\n  perPage: 15,\n  maxPages: 1,\n  searchTerm: '',\n};\n\nsearchFormEl.addEventListener('submit', handleSearchImages);\n\nasync function handleSearchImages(event) {\n  event.preventDefault();\n  galleryEl.innerHTML = '';\n\n  toggleVisibility(loadMoreButton, false);\n  queryParams.page = 1;\n\n  const form = event.currentTarget;\n  loadingSpinner.style.display = 'block';\n\n  const searchTerm = form.elements.search.value.trim();\n  queryParams.searchTerm = searchTerm;\n\n  try {\n    const data = await fetchImages(queryParams);\n\n    if (data.total === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n    }\n    queryParams.maxPages = Math.ceil(data.totalHits / queryParams.perPage);\n    galleryEl.innerHTML = generateImageMarkup(data.hits);\n    galleryModal.refresh();\n\n    if (queryParams.maxPages > queryParams.page) {\n      toggleVisibility(loadMoreButton, true);\n      loadMoreButton.addEventListener('click', paginateImages);\n    }\n  } catch (error) {\n    console.error(error);\n  } finally {\n    loadingSpinner.style.display = 'none';\n    form.reset();\n  }\n}\n\nasync function paginateImages() {\n  loadMoreButton.textContent = 'Loading...';\n  queryParams.page += 1;\n  loadingSpinner.style.display = 'block';\n\n  try {\n    const data = await fetchImages(queryParams);\n    const newMarkup = generateImageMarkup(data.hits);\n\n    galleryEl.insertAdjacentHTML('beforeend', newMarkup);\n    galleryModal.refresh();\n\n    const firstGalleryItem = document.querySelector('.photo-item');\n    const itemRect = firstGalleryItem.getBoundingClientRect();\n    window.scrollBy({\n      top: 2 * itemRect.height,\n      behavior: 'smooth',\n    });\n\n    if (queryParams.maxPages === queryParams.page) {\n      toggleVisibility(loadMoreButton, false);\n      loadMoreButton.removeEventListener('click', paginateImages);\n      iziToast.success({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        color: 'blue',\n        icon: false,\n      });\n    }\n  } catch (error) {\n    console.error(error);\n  } finally {\n    loadMoreButton.textContent = 'Load more';\n    loadingSpinner.style.display = 'none';\n  }\n}\n\nfunction toggleVisibility(element, show) {\n  if (show) {\n    element.classList.remove('hidden');\n  } else {\n    element.classList.add('hidden');\n  }\n}\n"],"names":["axios","API_KEY","fetchImages","page","perPage","searchTerm","data","generateImageMarkup","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","galleryModal","SimpleLightbox","galleryEl","loadingSpinner","loadMoreButton","searchFormEl","queryParams","handleSearchImages","event","toggleVisibility","form","iziToast","paginateImages","error","newMarkup","itemRect","element","show"],"mappings":"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"}